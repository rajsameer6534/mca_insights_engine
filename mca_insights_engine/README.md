# MCA Insights Engine ‚Äî Ready-to-Run Submission

A **representative, end-to-end implementation** of the MCA Insights Engine described in the assignment.  
It consolidates state-wise MCA snapshots, detects and logs daily changes, enriches changed records, and exposes an **AI-powered dashboard** plus an **optional REST API**.

> This repo ships with synthetic demo data for 5 states (Maharashtra, Gujarat, Delhi, Tamil Nadu, Karnataka) across **three consecutive dates** (2025-10-17, 2025-10-18, 2025-10-19).  
> You can plug in real MCA state CSVs later without changing the code (place them under `data/snapshots/<YYYY-MM-DD>/<state>.csv`).

---

## ‚úÖ What This Submission Covers (mapped to the spec)

### A. Data Integration
- Merge & clean five selected states into a **canonical master** (consistent columns, dedupe, numeric parsing).
- Columns used (canonical):  
  `CIN, Company_Name, Company_Class, Date_of_Incorporation, Authorized_Capital, Paidup_Capital, Company_Status, NIC_Code, Registered_Address, RoC, State`

### B. Change Detection
- Detects **New incorporations**, **Deregistered**, and **Field updates** (e.g., `Company_Status`, `Authorized_Capital`, etc.).
- Emits structured change logs **CSV** with columns:  
  `CIN, Change_Type, Field_Changed, Old_Value, New_Value, Date`
- Tracks across **three daily snapshots** in order and updates a **SQLite master DB**.

### C. Web-Based CIN Enrichment
- For up to **100 changed companies**, creates `outputs/enrichment/enriched_changes.csv` with columns:  
  `CIN, COMPANY_NAME, STATE, STATUS, SOURCE, FIELD, SOURCE_URL`
- By default uses **seeded/synthetic enrichment** for stability; optionally enables **live web enrichment** (ZaubaCorp, etc.) by setting `ENABLE_WEB_ENRICHMENT=true` in `.env`.

### D. Query Layer
- **Streamlit dashboard** (`apps/dashboard_app.py`) with:
  - Search by **CIN/Name**
  - Filters by **Year, State, Company Status**
  - **Change history** viewer per CIN
  - View **daily AI summary** cards
- **Optional REST API** (`/search_company`) via Flask:
  - `GET /search_company?cin=<CIN>`
  - `GET /search_company?name=<partial name>`

### E. AI-Powered Features
- **Automated daily summary** after updates:  
  Writes `outputs/summaries/daily_summary_<DATE>.json` and `.txt` with totals and notable status changes.
- **Conversational query** in the dashboard:  
  Natural language ‚Üí rule-based intent parser ‚Üí data queries  
  Example: ‚ÄúShow new incorporations in Maharashtra‚Äù, ‚ÄúHow many companies were struck off last month?‚Äù, ‚Äúmanufacturing ... authorized capital above 1000000‚Äù.

---

## üì¶ Project Structure

```
mca_insights_engine/
‚îú‚îÄ apps/
‚îÇ  ‚îú‚îÄ dashboard_app.py        # Streamlit UI
‚îÇ  ‚îî‚îÄ flask_api.py            # Run Flask REST API
‚îú‚îÄ data/
‚îÇ  ‚îî‚îÄ snapshots/
‚îÇ     ‚îú‚îÄ 2025-10-17/          # (Generated by sample_data_generator.py)
‚îÇ     ‚îú‚îÄ 2025-10-18/
‚îÇ     ‚îî‚îÄ 2025-10-19/
‚îú‚îÄ mca_insights/
‚îÇ  ‚îú‚îÄ __init__.py
‚îÇ  ‚îú‚îÄ ai_summary.py           # AI daily summaries (rule-based)
‚îÇ  ‚îú‚îÄ api.py                  # Flask application with /search_company
‚îÇ  ‚îú‚îÄ change_detector.py      # New/Deregistered/Field updates
‚îÇ  ‚îú‚îÄ config.py               # Paths, schema, states
‚îÇ  ‚îú‚îÄ database.py             # SQLite storage + changelog
‚îÇ  ‚îú‚îÄ enrichers.py            # Seeded or optional live web enrichment
‚îÇ  ‚îú‚îÄ integrate.py            # Snapshot consolidation & normalization
‚îÇ  ‚îú‚îÄ schema.py               # Data classes
‚îÇ  ‚îî‚îÄ utils.py                # Helpers
‚îú‚îÄ outputs/
‚îÇ  ‚îú‚îÄ changelogs/             # CSV change logs per date
‚îÇ  ‚îú‚îÄ enrichment/             # enriched_changes.csv (+ seed if provided)
‚îÇ  ‚îú‚îÄ summaries/              # daily_summary_*.json/.txt
‚îÇ  ‚îú‚îÄ master.db               # SQLite master
‚îÇ  ‚îî‚îÄ master_latest.csv       # CSV mirror of master
‚îú‚îÄ sample_data_generator.py   # Creates 3 demo snapshots (5 states each)
‚îú‚îÄ run_pipeline.py            # Orchestrates the E2E pipeline
‚îú‚îÄ requirements.txt
‚îú‚îÄ .env.example               # Turn on optional live enrichment
‚îú‚îÄ LICENSE
‚îî‚îÄ README.md (this file)
```

---

## üöÄ Quick Start (Demo, Zero Config)

> Requires: Python 3.10+

```bash
pip install -r requirements.txt

# 1) Generate demo snapshots for 5 states on 3 dates
python sample_data_generator.py

# 2) Run the daily pipeline (integrate -> detect -> master DB -> enrich -> AI summary)
python run_pipeline.py
```

**Outputs you can verify:**
- `outputs/master_latest.csv` ‚Äì Canonical merged dataset
- `outputs/master.db` ‚Äì SQLite with `companies` and `change_log`
- `outputs/changelogs/changes_2025-10-18.csv` and `changes_2025-10-19.csv`
- `outputs/enrichment/enriched_changes.csv` ‚Äì Enriched sample
- `outputs/summaries/daily_summary_2025-10-19.json` and `.txt`

---

## üñ•Ô∏è Run the Dashboard

```bash
streamlit run apps/dashboard_app.py
```

Then open the printed local URL.  
Try questions in **Chat with MCA Data** like:
- `Show new incorporations in Maharashtra`
- `How many companies were struck off last month?`
- `manufacturing authorized capital above 1000000`

---

## üîå Optional: REST API

```bash
export FLASK_APP=apps/flask_api.py
flask run -p 8000
# or: python apps/flask_api.py
```

Examples:
- `GET http://localhost:8000/search_company?cin=<CIN>`
- `GET http://localhost:8000/search_company?name=tech`

---

## üîé Using Real MCA Files

Place real state CSVs here for each date (repeat for multiple dates):
```
data/snapshots/<YYYY-MM-DD>/maharashtra.csv
data/snapshots/<YYYY-MM-DD>/gujarat.csv
data/snapshots/<YYYY-MM-DD>/delhi.csv
data/snapshots/<YYYY-MM-DD>/tamil_nadu.csv
data/snapshots/<YYYY-MM-DD>/karnataka.csv
```
Columns should include (or be mappable to) the canonical schema listed above. The code will normalize and dedupe by CIN.

---

## üåê Enrichment Notes

- Default: uses a **seeded** enrichment file for stability (`outputs/enrichment/enrichment_seed.csv` if present).
- Optional: to enable **live web enrichment** (best-effort scrapes/APIs), create `.env` from `.env.example` and set:
  ```
  ENABLE_WEB_ENRICHMENT=true
  ```
  The demo includes a simple ZaubaCorp parser (structure may change; this is for representative purposes only).

---

## üß™ Reproducibility & Auditability

- Every change is logged per CIN/day to CSV **and** SQLite.
- Master snapshot is fully reproducible from dated state files.
- The dashboard shows per-CIN change history.

---

## ‚úçÔ∏è Design Choices

- SQLite for a portable, auditable store.
- Pandas for consolidation and change detection.
- Streamlit for rapid, interactive insights + rule-based chatbot that can be replaced with LLM/RAG later.
- Seeded enrichment to ensure deterministic demo runs without internet dependency.

---

## üìÑ License

MIT. Do anything, at your own risk.

---

## üôè Credits

Sample dataset and code authored for the MCA Insights Engine assignment.  
Note: This is a **representative** implementation as permitted by the assignment brief.
